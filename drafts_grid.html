<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drafts Grid</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        /* ================================================= */
        /* –í–ò–ó–£–ê–õ–¨–ù–´–ô –°–¢–ò–õ–¨: –ü–∏–∫—Å–µ–ª—å–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞ –∏ —à—Ä–∏—Ñ—Ç */
        /* ================================================= */
        :root {
            --color-bg: #000000;          /* –ß–µ—Ä–Ω—ã–π —Ñ–æ–Ω */
            --color-dark-green: #013220;  /* –¢–µ–º–Ω–æ-–∑–µ–ª–µ–Ω—ã–π (—Ñ–æ–Ω —è—á–µ–µ–∫) */
            --color-light-green: #00FF00; /* –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π (–ø–∏–∫—Å–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã) */
        }
        
        body {
            background-color: var(--color-bg);
            color: var(--color-light-green);
            font-family: 'Press Start 2P', monospace;
            padding: 10px;
            margin: 0;
            overflow-x: hidden;
            user-select: none;
            cursor: default;
        }

        /* ================================================= */
        /* –ò–ù–¢–ï–†–§–ï–ô–°: –®–∞–ø–∫–∞ –∏ –°–µ—Ç–∫–∞ */
        /* ================================================= */

        #header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--color-light-green); /* –≠—Ñ—Ñ–µ–∫—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ */
            margin-bottom: 15px;
        }

        #monster-logo {
            /* 2GAME-LOGO.jpg - –õ–æ–≥–æ—Ç–∏–ø –º–æ–Ω—Å—Ç—Ä–∞ */
            width: 80px; 
            height: auto;
            image-rendering: pixelated;
        }

        #back-button {
            /* 5463093809924670725 –∫–æ–ø–∏—è.jpg - –ò–∫–æ–Ω–∫–∞ Helper/Back */
            background: none;
            border: none;
            padding: 0;
            cursor: pointer;
            line-height: 0; 
        }

        #back-button img {
            width: 30px;
            height: 30px;
            image-rendering: pixelated;
            filter: drop-shadow(0 0 2px var(--color-light-green)); /* –ü–∏–∫—Å–µ–ª—å–Ω—ã–π —Å–≤–µ—á–µ–Ω–∏–µ */
        }
        
        #grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 3 –∫–æ–ª–æ–Ω–∫–∏ */
            gap: 5px; /* –ü–∏–∫—Å–µ–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ */
            max-width: 100%;
        }

        .grid-cell {
            background-color: var(--color-dark-green);
            border: 2px solid var(--color-light-green);
            min-height: 100px;
            padding: 8px;
            cursor: pointer;
            font-size: 8px; /* –ü–∏–∫—Å–µ–ª—å–Ω—ã–π —à—Ä–∏—Ñ—Ç –º–∞–ª–µ–Ω—å–∫–∏–π */
            word-wrap: break-word;
            overflow: hidden;
            position: relative;
            transition: all 0.05s linear;
        }

        .grid-cell:hover {
            box-shadow: 0 0 5px var(--color-light-green); /* –≠—Ñ—Ñ–µ–∫—Ç —Å–∫–∞–Ω–∏—Ä—É—é—â–µ–≥–æ –∫—É—Ä—Å–æ—Ä–∞ */
            opacity: 0.9;
        }

        .empty-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(0, 255, 0, 0.4);
        }

        .content-type {
            font-size: 6px;
            color: var(--color-light-green);
            position: absolute;
            top: 2px;
            right: 4px;
        }
    </style>
</head>
<body>

    <div id="header">
        <img id="monster-logo" src="2GAME-LOGO.png" alt="Monster Logo">
        <button id="back-button" onclick="window.Telegram.WebApp.close()">
            <img src="5463093809924670725 –∫–æ–ø–∏—è.jpg" alt="Back Button">
        </button>
    </div>

    <div id="grid-container">
        </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –º—ã –≤–Ω—É—Ç—Ä–∏ Telegram WebApp
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
        }

        const GRID_SIZE = 15; // 3 —Ä—è–¥–∞ * 5 –∫–æ–ª–æ–Ω–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        const STORAGE_KEY = 'pixelDrafts_v1';

        // ================================================= 
        // üíæ –õ–û–ö–ê–õ–¨–ù–û–ï –•–†–ê–ù–ï–ù–ò–ï (LocalStorage)
        // =================================================

        function loadDrafts() {
            try {
                const draftsJson = localStorage.getItem(STORAGE_KEY);
                if (draftsJson) {
                    const drafts = JSON.parse(draftsJson);
                    // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—É—â–µ–º—É —Ä–∞–∑–º–µ—Ä—É —Å–µ—Ç–∫–∏
                    if (drafts.length === GRID_SIZE) {
                        return drafts;
                    }
                }
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è LocalStorage:", e);
            }
            // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∏–ª–∏ –æ–Ω–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã, —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—É—é —Å–µ—Ç–∫—É
            return Array(GRID_SIZE).fill({ type: 'empty', content: '' });
        }

        function saveDrafts(drafts) {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(drafts));
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ LocalStorage:", e);
                alert("–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω–æ.");
            }
        }

        // ================================================= 
        // üé® –†–ï–ù–î–ï–†–ò–ù–ì –ò –õ–û–ì–ò–ö–ê UI
        // =================================================

        let currentDrafts = loadDrafts();
        const gridContainer = document.getElementById('grid-container');

        function handleCellClick(index) {
            const draft = currentDrafts[index];
            const currentContent = draft.content || '';

            // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∏ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
            const inputResult = prompt(`–Ø–ß–ï–ô–ö–ê #${index + 1}\n–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –æ—á–∏—Å—Ç–∫–∏:\n(–î–æ–±–∞–≤–∏—Ç—å #ART –∏–ª–∏ #PUSH –≤ –Ω–∞—á–∞–ª–æ –¥–ª—è —Å–º–µ–Ω—ã —Ç–∏–ø–∞)`, currentContent);

            if (inputResult === null) {
                return; // –û—Ç–º–µ–Ω–∞
            }

            let newContent = inputResult.trim();
            let newType = 'text';

            if (newContent.toLowerCase().startsWith('#art')) {
                newType = 'art';
                newContent = newContent.substring(4).trim();
            } else if (newContent.toLowerCase().startsWith('#push')) {
                newType = 'push';
                newContent = newContent.substring(5).trim();
            } else if (newContent === '') {
                newType = 'empty';
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
            currentDrafts[index] = { 
                type: newType, 
                content: newContent 
            };
            
            saveDrafts(currentDrafts);
            renderGrid(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å–µ—Ç–∫—É
        }

        function getEmoji(type) {
            switch (type) {
                case 'art': return 'üñºÔ∏è';
                case 'push': return 'üîî';
                case 'text': return 'üìù';
                default: return '';
            }
        }

        function renderGrid() {
            gridContainer.innerHTML = ''; // –û—á–∏—Å—Ç–∫–∞
            
            // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ 5 –∫–æ–ª–æ–Ω–æ–∫, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            gridContainer.style.gridTemplateRows = `repeat(${Math.ceil(GRID_SIZE / 3)}, auto)`;


            currentDrafts.forEach((draft, index) => {
                const cell = document.createElement('div');
                cell.className = 'grid-cell';
                cell.onclick = () => handleCellClick(index); 

                if (draft.type === 'empty' || draft.content === '') {
                    cell.innerHTML = `<span class="empty-text">–ü–£–°–¢–û</span>`;
                } else {
                    const typeLabel = document.createElement('div');
                    typeLabel.className = 'content-type';
                    typeLabel.textContent = `${getEmoji(draft.type)} ${draft.type.toUpperCase()}`;
                    cell.appendChild(typeLabel);
                    
                    const contentText = document.createElement('div');
                    contentText.textContent = draft.content.substring(0, 150) + (draft.content.length > 150 ? '...' : '');
                    cell.appendChild(contentText);
                }

                gridContainer.appendChild(cell);
            });
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Ç—Ä–∏—Å–æ–≤–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        renderGrid();
    </script>
</body>
</html>